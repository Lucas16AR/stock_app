{% extends "base.html" %}
{% block content %}
<h4>Registrar venta</h4>
<form method="post">
  <div class="row g-2 align-items-end">
    <div class="col-md-6">
      <label class="form-label">Producto</label>
      <select class="form-select" name="producto_id" required>
        {% for p in productos %}
          <option value="{{ p.id }}">{{ p.nombre }} (Stock: {{ p.cantidad }})</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-2"><label class="form-label">Cantidad</label><input class="form-control" type="number" name="cantidad" value="1" required></div>
    <div class="col-md-2"><label class="form-label">Precio venta</label><input class="form-control" type="number" step="0.01" name="precio_venta" required></div>
    <div class="col-md-2"><button class="btn btn-primary">Registrar</button></div>
  </div>
</form>

<hr>
<h5>Historial</h5>
<ul class="list-group">
  {% for v in ventas %}
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <div>
        <strong>{{ v.cantidad }}</strong> x {% if v.producto %} {{ v.producto.nombre }} {% else %} <em>Producto eliminado</em> {% endif %}
        <div class="small text-muted">{{ v.fecha.strftime('%d/%m/%Y %H:%M') }}</div>
      </div>
      <div><strong>${{ v.precio_venta }}</strong></div>
    </li>
  {% else %}
    <li class="list-group-item">No hay ventas.</li>
  {% endfor %}
</ul>
{% endblock %}